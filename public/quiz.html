<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Mini PDF Quiz</title>

<style>
  body {
    font-family: system-ui, -apple-system, sans-serif;
    margin: 0;
    background: #f4f6f8;
  }

  .container {
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    height: 100vh;
  }

  iframe {
    width: 100%;
    height: 100%;
    border: none;
    background: #fff;
  }

  .answers {
    overflow-y: auto;
    padding: 20px;
    background: #ffffff;
    border-left: 1px solid #ddd;
  }

  h2 {
    margin-top: 0;
  }

  .question {
    margin-bottom: 20px;
  }

  .question-title {
    font-weight: 600;
    margin-bottom: 6px;
  }

  label {
    display: block;
    margin: 4px 0;
    cursor: pointer;
  }

  button {
    padding: 10px 16px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 20px;
  }

  .score {
    margin-top: 16px;
    font-size: 18px;
    font-weight: bold;
  }
  .correct {
  background: #e6f7e6;
  border-left: 4px solid #2ecc71;
  padding-left: 6px;
}

.incorrect {
  background: #fdecea;
  border-left: 4px solid #e74c3c;
  padding-left: 6px;
}

.disabled input {
  pointer-events: none;
}

</style>
</head>

<body>

<div class="container">

  <!-- PDF VIEW -->
  <iframe src="set1.pdf"></iframe>

  <!-- ANSWER SHEET -->
  <div class="answers">
    <h2>Answer Sheet</h2>
    <div id="quiz"></div>
    <button onclick="checkScore()">Check My Score</button>
    <div id="score" class="score"></div>
  </div>

</div>

<script>
/* ==========================
   QUIZ DATA (JSON)
   ========================== */

const quizData = [
  {
    part: "Part 1",
    questions: [
      { id: 1, type: "single", correct: ["A"], choices: {
        A: "It is not difficult to imagine what they looked like.",
        B: "There were great numbers of them.",
        C: "They lived only in the sea.",
        D: "They did not leave many fossil remains."
      }},
      { id: 2, type: "single", correct: ["C"], choices: {
        A: "Exact",
        B: "Scarce",
        C: "Valuable",
        D: "Initial"
      }},
      { id: 3, type: "single", correct: ["C"], choices: {
        A: "Hearing structures",
        B: "Adaptations for diving",
        C: "Skull shapes",
        D: "Breeding locations"
      }},
      { id: 4, type: "single", correct: ["A"], choices: {
        A: "Pakicetus",
        B: "Fish",
        C: "Life",
        D: "Ocean"
      }},
      { id: 5, type: "single", correct: ["B"], choices: {
        A: "Explained",
        B: "Visible",
        C: "Identified",
        D: "Located"
      }},
      { id: 6, type: "single", correct: ["D"], choices: {
        A: "Lived later than Ambulocetus natans",
        B: "Lived at the same time as Pakicetus",
        C: "Was able to swim well",
        D: "Could not have walked on land"
      }},
      { id: 7, type: "single", correct: ["B"], choices: {
        A: "Fossil legs are rare",
        B: "The legs provided important evolutionary information",
        C: "It allowed a full skeleton reconstruction",
        D: "Only front legs had been discovered before"
      }},
      { id: 8, type: "single", correct: ["C"], choices: {
        A: "Ambulocetus swam but had no backbone",
        B: "Its backbone proves it had a fluke",
        C: "It swam like modern whales despite lacking a fluke",
        D: "Modern whales swim differently from Ambulocetus"
      }},
      { id: 9, type: "single", correct: ["B"], choices: {
        A: "Choice A",
        B: "Choice B",
        C: "Choice C",
        D: "Choice D"
      }},
      { id: 10, type: "multi", points: 2, correct: ["A", "B", "E"], choices: {
        A: "Recent fossil discoveries link land mammals and cetaceans",
        B: "Ambulocetus lived both on land and at sea",
        C: "Basilosaurus was found in the Tethys Sea",
        D: "Pakicetus is the oldest fossil whale",
        E: "Transitional fossils were discovered",
        F: "Ambulocetus used hind legs for propulsion"
      }}
    ]
  },

  {
    part: "Part 2",
    questions: [
      { id: 1, type: "single", correct: ["B"], choices: {
        A: "Restricted",
        B: "Endangered",
        C: "Prevented",
        D: "Rejected"
      }},
      { id: 2, type: "single", correct: ["B"], choices: {
        A: "Increased stone content",
        B: "Reduced water absorption",
        C: "More soil spaces",
        D: "Reduced runoff"
      }},
      { id: 3, type: "single", correct: ["A"], choices: {
        A: "Fragile",
        B: "Predictable",
        C: "Complex",
        D: "Valuable"
      }},
      { id: 4, type: "single", correct: ["A"], choices: {
        A: "Adjusting to settlement stresses",
        B: "Retaining fertility",
        C: "Providing irrigation water",
        D: "Attracting populations"
      }},
      { id: 5, type: "single", correct: ["D"], choices: {
        A: "Openly",
        B: "Impressively",
        C: "Objectively",
        D: "Increasingly"
      }},
      { id: 6, type: "single", correct: ["C"], choices: {
        A: "Poor irrigation techniques",
        B: "Unsuitable crops",
        C: "Removal of original vegetation",
        D: "Excessive animal waste use"
      }},
      { id: 7, type: "single", correct: ["D"], choices: {
        A: "Interfere with irrigation",
        B: "Limit evaporation",
        C: "Increase air absorption",
        D: "Bring salts to the surface"
      }},
      { id: 8, type: "single", correct: ["A"], choices: {
        A: "Desertification is hard to reverse and affects many people",
        B: "Population growth causes desertification",
        C: "It can only be solved internationally",
        D: "Reducing population is required"
      }},
      { id: 9, type: "single", correct: ["B"], choices: {
        A: "Choice A",
        B: "Choice B",
        C: "Choice C",
        D: "Choice D"
      }},
      { id: 10, type: "multi", points: 2, correct: ["A", "C", "D"], choices: {
        A: "Population growth and agriculture disrupted ecosystems",
        B: "Crop failures increased due to dryness",
        C: "Overgrazing and firewood gathering removed vegetation",
        D: "Poor irrigation caused soil salinization",
        E: "Animal dung enriches soil",
        F: "Grasses dominate semiarid lands"
      }}
    ]
  }
];

/* ==========================
   RENDER
   ========================== */

const quizEl = document.getElementById("quiz");

quizData.forEach(part => {
  const h = document.createElement("h3");
  h.textContent = part.part;
  quizEl.appendChild(h);

  part.questions.forEach(q => {
    const div = document.createElement("div");
    div.className = "question";

    div.innerHTML = `<div class="question-title">Question ${q.id}</div>`;

    Object.entries(q.choices).forEach(([key, text]) => {
      const type = q.type === "multi" ? "checkbox" : "radio";
      const name = `${part.part}-${q.id}`;

      div.innerHTML += `
        <label>
          <input type="${type}" name="${name}" value="${key}">
          ${key}. ${text}
        </label>`;
    });

    quizEl.appendChild(div);
  });
});

/* ==========================
   SCORING
   ========================== */

function checkScore() {
  let score = 0;

  quizData.forEach(part => {
    part.questions.forEach(q => {
      const name = `${part.part}-${q.id}`;
      const inputs = document.querySelectorAll(`input[name="${name}"]`);
      const selected = [...inputs].filter(i => i.checked).map(i => i.value).sort();
      const correct = q.correct.slice().sort();

      const isCorrect =
        JSON.stringify(selected) === JSON.stringify(correct);

      if (isCorrect) {
        score += q.type === "multi" ? q.points : 1;
      }

      // Highlight answers
      inputs.forEach(input => {
        const label = input.parentElement;
        label.classList.remove("correct", "incorrect");

        if (q.correct.includes(input.value)) {
          label.classList.add("correct");
        } else if (input.checked) {
          label.classList.add("incorrect");
        }
      });

      // Disable question after grading
      inputs.forEach(input => input.disabled = true);
      inputs[0].closest(".question").classList.add("disabled");
    });
  });

  document.getElementById("score").innerHTML = `
    Your score: <strong>${score} points</strong><br><br>
    <button onclick="goToListening()">Go to Listening Section</button>
  `;
}


function goToListening() {
  window.location.href = "https://daltera.github.io/quiz2.html";
}

</script>

</body>
</html>
